{"version":3,"file":"static/js/884.b6542c7e.chunk.js","mappings":"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","sources":["AdminPage.tsx"],"sourcesContent":["import { Alert, Box, Button, CircularProgress, Divider, Stack, TextField, Typography } from \"@mui/material\";\nimport axios from \"axios\";\nimport { useState } from \"react\";\nimport Voucher from \"./Interfaces/Voucher\";\n\nconst AdminPage = () => {\n  const [loading, setLoading] = useState(false);\n  const [state, setState] = useState<'search' | 'voucher' | 'result'>('search');\n\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [query, setQuery] = useState('');\n\n  const [voucher, setVoucher] = useState<Voucher | null>(null);\n\n  const handleSearchVoucher = async () => {\n    setLoading(true);\n\n    const voucher = await fetchVoucher();\n\n    if (voucher) {\n      setVoucher(voucher);\n      setState('voucher');\n\n      const promo = voucher.Promo;\n\n      if (promo) {\n        if (promo.remaining <= 0) {\n          setErrorMessage('Promo ini sudah habis diklaim.');\n        }\n        if (new Date(promo.expiry) < new Date()) {\n          setErrorMessage('Promo ini sudah berakhir.');\n        }\n      }\n\n      if (voucher.claimed) {\n        setErrorMessage(`Voucher ini sudah pernah diklaim pada ${formatDate(voucher.claimedAt)}.`);\n      }\n    }\n\n    setLoading(false);\n  }\n\n  const handleClaimVoucher = async () => {\n    setLoading(true);\n\n    setErrorMessage(null);\n    try {\n      const ret = await axios.post<Voucher>(`/api/vouchers/${query}/redeem`);\n    } catch (error) {\n      if (axios.isAxiosError(error)) {\n        const data = error.response?.data;\n\n        setErrorMessage(data?.error ?? 'Error hahaha');\n      } else {\n        setErrorMessage((error as any)?.message ?? 'Error hahaha');\n      }\n    }\n    setState('result');\n\n    setLoading(false);\n  }\n\n  const fetchVoucher = async () => {\n    setErrorMessage(null);\n\n    try {\n      const ret = await axios.get<Voucher>(`/api/vouchers/${query}`);\n\n      return ret.data;\n    } catch (error) {\n      if (axios.isAxiosError(error)) {\n        const data = error.response?.data;\n\n        setErrorMessage(data?.error ?? '');\n      } else {\n        setErrorMessage((error as any)?.message ?? '');\n      }\n\n      return null;\n    }\n  }\n\n  const formatDate = (date: Date | string) => {\n    return new Date(date).toLocaleDateString('id', { year: 'numeric', month: 'long', day: 'numeric' });\n  }\n\n  const handleReset = () => {\n    setVoucher(null);\n    setState('search');\n    setErrorMessage(null);\n  }\n\n  if (loading) {\n    return (\n      <CircularProgress />\n    );\n  }\n\n  if (state === 'search') {\n    return (\n      <Stack direction='column' sx={{ width: '100%', height: '100dvh', justifyContent: 'center' }}>\n        {errorMessage &&\n          <Alert severity=\"error\">{errorMessage}</Alert>\n        }\n        <Box flexGrow='1' />\n        <Typography textAlign='center' marginTop='10px' fontSize='15pt'>Cek voucher:</Typography>\n        <TextField\n          inputProps={{\n            style: {\n              textAlign: 'center',\n              fontSize: '20pt'\n            }\n          }}\n          sx={{ mx: '20px' }}\n          value={query} onChange={e => setQuery(e.target.value.toUpperCase())} />\n\n        <Box flexGrow='1' />\n\n        <Button type='submit' sx={{\n          backgroundColor: 'black',\n          color: 'white',\n          mx: '20px', mb: '20px',\n          p: '15px', textTransform: 'none', fontSize: '20pt',\n          borderRadius: '20px',\n        }}\n          variant=\"contained\"\n          onClick={handleSearchVoucher}\n        >Cari</Button>\n      </Stack>\n    );\n  }\n\n  else if (state === 'voucher') {\n    return (\n      <Stack direction='column' sx={{ width: '100%' }}>\n        {errorMessage &&\n          <Alert severity=\"error\">{errorMessage}</Alert>\n        }\n\n        <Typography alignSelf='center' marginTop='10px' fontSize='15pt'>Kode voucher:</Typography>\n        <Typography fontWeight='bold' textAlign='center' fontSize='30pt' textTransform='uppercase'>{voucher?.code}</Typography>\n        <Divider />\n\n        {voucher?.Promo &&\n          <>\n            <img src={`/${voucher.Promo.image}`} width='80%' style={{ alignSelf: 'center', marginTop: '20px' }} />\n            <Typography fontWeight='bold' alignSelf='center' marginTop='20px' fontSize='18pt'>{voucher.Promo.name}</Typography>\n            <Typography alignSelf='center' marginTop='10px' fontSize='12pt'>{voucher.Promo.description}</Typography>\n\n            <Typography alignSelf='center' marginTop='20px'>Berlaku sampai {formatDate(voucher.Promo.expiry)}.</Typography>\n\n            {!errorMessage &&\n              <Button type='submit' sx={{\n                backgroundColor: 'black',\n                color: 'white',\n                mx: '20px', mt: '20px', mb: '20px', p: '15px', textTransform: 'none', fontSize: '20pt',\n                borderRadius: '20px',\n              }}\n                variant=\"contained\"\n                onClick={handleClaimVoucher}\n              >Klaim</Button>\n            }\n          </>\n        }\n      </Stack>\n    );\n  }\n\n  else if (state === 'result') {\n    return (\n      <Stack direction='column' sx={{ width: '100%' }}>\n        <Box flexGrow='1' />\n        {errorMessage ?\n          <>\n            <Typography fontWeight='bold' alignSelf='center' marginTop='20px' fontSize='30pt'>Klaim gagal...</Typography>\n            <Typography alignSelf='center' marginTop='10px' fontSize='12pt'>{errorMessage}</Typography>\n          </>\n          :\n          <>\n            <Typography fontWeight='bold' alignSelf='center' marginTop='20px' fontSize='30pt'>Klaim berhasil!</Typography>\n            <Typography alignSelf='center' marginTop='10px' fontSize='12pt'>{voucher?.Promo?.description}</Typography>\n          </>\n        }\n        <Box flexGrow='1' />\n        <Button type='submit' sx={{\n          backgroundColor: 'black',\n          color: 'white',\n          mx: '20px', mb: '20px',\n          p: '15px', textTransform: 'none', fontSize: '20pt',\n          borderRadius: '20px',\n        }}\n          variant=\"contained\"\n          onClick={handleReset}\n        >Kembali</Button>\n      </Stack>\n    )\n  }\n\n  return (\n    <div></div>\n  );\n}\n\nexport default AdminPage;"],"names":["AdminPage","loading","setLoading","useState","state","setState","errorMessage","setErrorMessage","query","setQuery","voucher","setVoucher","handleSearchVoucher","async","fetchVoucher","promo","Promo","remaining","Date","expiry","claimed","concat","formatDate","claimedAt","handleClaimVoucher","axios","post","error","isAxiosError","_error$response","_data$error","data","response","_message","message","get","_error$response2","_data$error2","_message2","date","toLocaleDateString","year","month","day","handleReset","_jsx","CircularProgress","_jsxs","Stack","direction","sx","width","height","justifyContent","children","Alert","severity","Box","flexGrow","Typography","textAlign","marginTop","fontSize","TextField","inputProps","style","mx","value","onChange","e","target","toUpperCase","Button","type","backgroundColor","color","mb","p","textTransform","borderRadius","variant","onClick","alignSelf","fontWeight","code","Divider","_Fragment","src","image","name","description","mt","_voucher$Promo"],"sourceRoot":""}